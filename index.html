<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akina Check - Informe de Chequeo Vehicular</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-color: #bdc3c7;
            --text-color: #333;
            --text-light: #7f8c8d;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            color: var(--text-color);
            background-color: #f8f9fa;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px 8px 0 0;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* Contenedores principales */
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .section {
            background-color: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }
        
        .section-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--secondary-color);
        }
        
        /* Portada del informe */
        .cover-section {
            grid-column: 1 / -1;
            padding: 30px;
            background: linear-gradient(to bottom, white 0%, #f8f9fa 100%);
            border-left: 6px solid var(--primary-color);
        }
        
        .cover-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .cover-header h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .cover-header p {
            color: var(--text-light);
            font-size: 1.1rem;
        }
        
        .recommendation-section {
            margin: 30px 0;
            padding: 25px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .recommendation-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .recommendation-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .recommendation-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            min-width: 180px;
        }
        
        .recommendation-option:hover {
            background-color: rgba(236, 240, 241, 0.5);
        }
        
        .recommendation-option.selected {
            border-color: currentColor;
            background-color: rgba(236, 240, 241, 0.8);
        }
        
        .recommendation-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .option-apto {
            color: var(--success-color);
        }
        
        .option-observaciones {
            color: var(--warning-color);
        }
        
        .option-no-recomendado {
            color: var(--danger-color);
        }
        
        .recommendation-text {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .fundamento-container {
            margin-top: 20px;
        }
        
        .fundamento-container label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .fundamento-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: var(--font-main);
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
        }
        
        .fundamento-input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .vehicle-data-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 600px) {
            .vehicle-data-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: var(--font-main);
            font-size: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        /* Checklist */
        .checklist-container {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .checklist-category {
            margin-bottom: 25px;
        }
        
        .category-title {
            font-size: 1.2rem;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }
        
        .category-critical {
            background-color: #c0392b;
        }
        
        .category-safety {
            background-color: #e67e22;
        }
        
        .category-legal {
            background-color: #2980b9;
        }
        
        .category-esthetic {
            background-color: #7f8c8d;
        }
        
        .checklist-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            margin-bottom: 12px;
            background-color: white;
            transition: all 0.2s ease;
        }
        
        .checklist-item:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .item-text {
            flex: 1;
            font-size: 1rem;
        }
        
        .item-status {
            display: flex;
            gap: 8px;
        }
        
        .status-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            font-size: 1.2rem;
            background-color: #f8f9fa;
        }
        
        .status-btn:hover {
            transform: scale(1.1);
        }
        
        .status-conforme {
            color: var(--success-color);
            border-color: var(--success-color);
        }
        
        .status-conforme.selected {
            background-color: var(--success-color);
            color: white;
        }
        
        .status-observacion {
            color: var(--warning-color);
            border-color: var(--warning-color);
        }
        
        .status-observacion.selected {
            background-color: var(--warning-color);
            color: white;
        }
        
        .status-no-conforme {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        
        .status-no-conforme.selected {
            background-color: var(--danger-color);
            color: white;
        }
        
        /* Asistencia inteligente */
        .assistance-container {
            display: flex;
            justify-content: space-between;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 25px;
            border: 1px solid var(--border-color);
        }
        
        .counter {
            text-align: center;
            flex: 1;
        }
        
        .counter-value {
            font-size: 2.2rem;
            font-weight: 700;
            display: block;
        }
        
        .counter-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .observations-counter .counter-value {
            color: var(--warning-color);
        }
        
        .nonconformities-counter .counter-value {
            color: var(--danger-color);
        }
        
        .assistance-message {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
            font-style: italic;
        }
        
        /* Vista previa del informe */
        .report-preview {
            grid-column: 1 / -1;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-color);
        }
        
        .report-header h2 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .report-cover-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .recommendation-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .badge-apto {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--success-color);
        }
        
        .badge-observaciones {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .badge-no-recomendado {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .checklist-summary {
            margin: 30px 0;
        }
        
        .summary-category {
            margin-bottom: 25px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--light-color);
        }
        
        .summary-status {
            font-weight: 600;
        }
        
        .summary-status-conforme {
            color: var(--success-color);
        }
        
        .summary-status-observacion {
            color: var(--warning-color);
        }
        
        .summary-status-no-conforme {
            color: var(--danger-color);
        }
        
        /* Botones */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            grid-column: 1 / -1;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 6px;
            font-family: var(--font-main);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1a252f;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* Bloque comercial */
        .commercial-block {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 30px;
            border-top: 1px solid var(--border-color);
            grid-column: 1 / -1;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 25px;
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 40px;
            border-top: 1px solid var(--border-color);
            grid-column: 1 / -1;
        }
        
        .footer a {
            color: var(--secondary-color);
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* Estilos para impresi贸n/PDF */
        @media print {
            .no-print, .action-buttons, .commercial-block {
                display: none !important;
            }
            
            body {
                max-width: 100%;
                padding: 0;
                background-color: white;
            }
            
            .section {
                box-shadow: none;
                border: none;
                padding: 15px;
            }
            
            .report-preview {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header con marca -->
    <header class="header">
        <h1>AKINA CHECK</h1>
        <p>Informe profesional de chequeo vehicular</p>
    </header>

    <!-- Portada del informe -->
    <section class="section cover-section">
        <div class="cover-header">
            <h2>Informe profesional de chequeo vehicular</h2>
            <p>Documento de evaluaci贸n t茅cnica</p>
        </div>
        
        <div class="recommendation-section">
            <h3 class="recommendation-title">Recomendaci贸n del inspector</h3>
            
            <div class="recommendation-options">
                <div class="recommendation-option option-apto" data-value="apto">
                    <div class="recommendation-icon"></div>
                    <div class="recommendation-text">Apto para compra</div>
                </div>
                
                <div class="recommendation-option option-observaciones" data-value="observaciones">
                    <div class="recommendation-icon"></div>
                    <div class="recommendation-text">Apto con observaciones</div>
                </div>
                
                <div class="recommendation-option option-no-recomendado" data-value="no-recomendado">
                    <div class="recommendation-icon"></div>
                    <div class="recommendation-text">No recomendado</div>
                </div>
            </div>
            
            <div class="fundamento-container">
                <label for="fundamento">Fundamento de la recomendaci贸n (M谩x. 2-3 l铆neas)</label>
                <textarea id="fundamento" class="fundamento-input" placeholder="Escriba aqu铆 el fundamento de su recomendaci贸n..." maxlength="200"></textarea>
                <div style="text-align: right; font-size: 0.8rem; color: var(--text-light); margin-top: 5px;">
                    <span id="char-count">0</span>/200 caracteres
                </div>
            </div>
        </div>
        
        <div class="vehicle-data-grid">
            <div class="form-group">
                <label for="vehiculo">Veh铆culo</label>
                <input type="text" id="vehiculo" class="form-control" placeholder="Ej: Ford Focus Titanium 2.0">
            </div>
            
            <div class="form-group">
                <label for="dominio">Dominio</label>
                <input type="text" id="dominio" class="form-control" placeholder="Ej: AB 123 CD">
            </div>
            
            <div class="form-group">
                <label for="kilometraje">Kilometraje</label>
                <input type="text" id="kilometraje" class="form-control" placeholder="Ej: 85,500 km">
            </div>
            
            <div class="form-group">
                <label for="fecha">Fecha de inspecci贸n</label>
                <input type="date" id="fecha" class="form-control" value="">
            </div>
        </div>
    </section>

    <!-- Contenedor principal -->
    <div class="container">
        <!-- Datos del veh铆culo y observaciones generales -->
        <section class="section">
            <h2 class="section-title"><i class="fas fa-car"></i> Datos del veh铆culo</h2>
            
            <div class="form-group">
                <label for="observacion-general">Observaci贸n general (opcional)</label>
                <textarea id="observacion-general" class="form-control" rows="4" placeholder="Observaciones generales sobre el veh铆culo..."></textarea>
            </div>
            
            <!-- Asistencia inteligente -->
            <div class="assistance-container">
                <div class="counter observations-counter">
                    <span class="counter-value" id="observaciones-count">0</span>
                    <span class="counter-label">Observaciones detectadas</span>
                </div>
                
                <div class="counter nonconformities-counter">
                    <span class="counter-value" id="no-conformes-count">0</span>
                    <span class="counter-label">tems no conformes</span>
                </div>
            </div>
            
            <div class="assistance-message no-print" id="assistance-message">
                <!-- Mensaje de asistencia se actualizar谩 din谩micamente -->
                Complete el checklist para ver recomendaciones de asistencia.
            </div>
        </section>

        <!-- Checklist profesional -->
        <section class="section">
            <h2 class="section-title"><i class="fas fa-clipboard-check"></i> Checklist de inspecci贸n</h2>
            
            <div class="checklist-container" id="checklist-container">
                <!-- Los 铆tems del checklist se generar谩n din谩micamente con JavaScript -->
            </div>
        </section>
    </div>

    <!-- Vista previa del informe -->
    <section class="report-preview" id="report-preview">
        <div class="report-header">
            <h2>INFORME DE CHEQUEO VEHICULAR</h2>
            <p>AKINA CHECK - Evaluaci贸n t茅cnica profesional</p>
        </div>
        
        <div class="report-cover-info">
            <div>
                <div><strong>Veh铆culo:</strong> <span id="preview-vehiculo">[No especificado]</span></div>
                <div><strong>Dominio:</strong> <span id="preview-dominio">[No especificado]</span></div>
                <div><strong>Kilometraje:</strong> <span id="preview-kilometraje">[No especificado]</span></div>
                <div><strong>Fecha de inspecci贸n:</strong> <span id="preview-fecha">[No especificada]</span></div>
            </div>
            
            <div>
                <div><strong>Recomendaci贸n:</strong></div>
                <div class="recommendation-badge" id="preview-recomendacion-badge">No seleccionada</div>
                <div id="preview-fundamento">[No especificado]</div>
            </div>
        </div>
        
        <div>
            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Observaci贸n general</h3>
            <p id="preview-observacion-general">[Sin observaciones generales]</p>
        </div>
        
        <div class="checklist-summary" id="checklist-summary">
            <!-- Resumen del checklist se generar谩 din谩micamente -->
        </div>
        
        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border-color);">
            <p><strong>Informe realizado por Akina Check</strong></p>
            <p style="font-size: 0.9rem; color: var(--text-light);">
                Desarrollado por AFM Solutions 路 afmsolutions.com.ar
            </p>
        </div>
    </section>

    <!-- Botones de acci贸n -->
    <div class="action-buttons no-print">
        <button class="btn btn-primary" id="update-preview-btn">
            <i class="fas fa-sync-alt"></i> Actualizar vista previa
        </button>
        <button class="btn btn-success" id="download-pdf-btn">
            <i class="fas fa-file-pdf"></i> Descargar informe (PDF)
        </button>
    </div>

    <!-- Bloque comercial -->
    <div class="commercial-block no-print">
        <p>Versi贸n de muestra. Funciones avanzadas disponibles bajo contrataci贸n.</p>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>AKINA CHECK - Sistema de informes de chequeo vehicular</p>
        <p>Desarrollado por AFM Solutions 路 <a href="https://afmsolutions.com.ar" target="_blank">afmsolutions.com.ar</a></p>
    </footer>

    <!-- Incluir jsPDF para exportaci贸n a PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        // Datos del checklist
        const checklistItems = [
            { id: 1, category: 'critical', text: 'Motor: funcionamiento, ruidos anormales, fugas de aceite o refrigerante' },
            { id: 2, category: 'critical', text: 'Transmisi贸n: cambios, ruidos, fugas de aceite' },
            { id: 3, category: 'critical', text: 'Sistema de frenos: funcionamiento, desgaste de pastillas, nivel de l铆quido' },
            { id: 4, category: 'safety', text: 'Suspensi贸n: amortiguadores, brazos, r贸tulas, silentblocks' },
            { id: 5, category: 'safety', text: 'Direcci贸n: alineaci贸n, funcionamiento, juego en volante' },
            { id: 6, category: 'safety', text: 'Neum谩ticos: desgaste, presi贸n, estado general' },
            { id: 7, category: 'safety', text: 'Sistema el茅ctrico: bater铆a, alternador, luces, instrumentos' },
            { id: 8, category: 'legal', text: 'Documentaci贸n: VTV vigente, c茅dula verde/azul, patente' },
            { id: 9, category: 'legal', text: 'Identificaci贸n: n煤mero de chasis y motor coincidentes con documentaci贸n' },
            { id: 10, category: 'legal', text: 'Historial: verificaci贸n de choques importantes o reparaciones estructurales' },
            { id: 11, category: 'esthetic', text: 'Carrocer铆a: pintura, abolladuras, 贸xido, estado general' },
            { id: 12, category: 'esthetic', text: 'Interior: tapizados, tablero, funcionamiento de accesorios' },
            { id: 13, category: 'esthetic', text: 'Vidrios y espejos: estado, funcionamiento' },
            { id: 14, category: 'esthetic', text: 'Limpieza general: interior y exterior' },
            { id: 15, category: 'safety', text: 'Seguridad activa: ABS, ESP, airbags (verificar testigos)' }
        ];

        // Categor铆as del checklist
        const categories = {
            critical: { name: 'Cr铆tico', class: 'category-critical' },
            safety: { name: 'Seguridad', class: 'category-safety' },
            legal: { name: 'Legal', class: 'category-legal' },
            esthetic: { name: 'Est茅tico', class: 'category-esthetic' }
        };

        // Estado inicial
        let selectedRecommendation = null;
        let checklistStatus = {};
        
        // Inicializar la aplicaci贸n
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha actual por defecto
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fecha').value = today;
            
            // Inicializar checklist
            initializeChecklist();
            
            // Inicializar vista previa
            updatePreview();
            
            // Configurar eventos
            setupEventListeners();
            
            // Actualizar contador de caracteres
            document.getElementById('fundamento').addEventListener('input', function() {
                document.getElementById('char-count').textContent = this.value.length;
            });
        });
        
        // Inicializar checklist
        function initializeChecklist() {
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';
            
            // Agrupar 铆tems por categor铆a
            const itemsByCategory = {};
            checklistItems.forEach(item => {
                if (!itemsByCategory[item.category]) {
                    itemsByCategory[item.category] = [];
                }
                itemsByCategory[item.category].push(item);
            });
            
            // Crear secciones por categor铆a
            Object.keys(categories).forEach(categoryKey => {
                const category = categories[categoryKey];
                const categoryItems = itemsByCategory[categoryKey] || [];
                
                if (categoryItems.length > 0) {
                    const categorySection = document.createElement('div');
                    categorySection.className = 'checklist-category';
                    
                    const categoryTitle = document.createElement('div');
                    categoryTitle.className = `category-title ${category.class}`;
                    categoryTitle.innerHTML = `
                        <span>${category.name}</span>
                        <span>${categoryItems.length} 铆tems</span>
                    `;
                    
                    categorySection.appendChild(categoryTitle);
                    
                    // Agregar 铆tems de esta categor铆a
                    categoryItems.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'checklist-item';
                        itemElement.dataset.id = item.id;
                        
                        itemElement.innerHTML = `
                            <div class="item-text">${item.text}</div>
                            <div class="item-status">
                                <div class="status-btn status-conforme" data-status="conforme" title="Conforme">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="status-btn status-observacion" data-status="observacion" title="Observaci贸n">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="status-btn status-no-conforme" data-status="no-conforme" title="No conforme">
                                    <i class="fas fa-times"></i>
                                </div>
                            </div>
                        `;
                        
                        categorySection.appendChild(itemElement);
                        
                        // Inicializar estado
                        if (!checklistStatus[item.id]) {
                            checklistStatus[item.id] = null;
                        }
                        
                        // Configurar eventos para botones de estado
                        const statusButtons = itemElement.querySelectorAll('.status-btn');
                        statusButtons.forEach(button => {
                            button.addEventListener('click', function() {
                                const status = this.dataset.status;
                                const itemId = parseInt(itemElement.dataset.id);
                                setChecklistStatus(itemId, status, itemElement);
                            });
                        });
                    });
                    
                    container.appendChild(categorySection);
                }
            });
            
            updateCounters();
        }
        
        // Establecer estado de un 铆tem del checklist
        function setChecklistStatus(itemId, status, itemElement) {
            checklistStatus[itemId] = status;
            
            // Actualizar interfaz
            const statusButtons = itemElement.querySelectorAll('.status-btn');
            statusButtons.forEach(button => {
                if (button.dataset.status === status) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });
            
            updateCounters();
            updateAssistanceMessage();
        }
        
        // Actualizar contadores de observaciones y no conformes
        function updateCounters() {
            let observaciones = 0;
            let noConformes = 0;
            
            Object.values(checklistStatus).forEach(status => {
                if (status === 'observacion') observaciones++;
                if (status === 'no-conforme') noConformes++;
            });
            
            document.getElementById('observaciones-count').textContent = observaciones;
            document.getElementById('no-conformes-count').textContent = noConformes;
        }
        
        // Actualizar mensaje de asistencia
        function updateAssistanceMessage() {
            const messageElement = document.getElementById('assistance-message');
            const observaciones = parseInt(document.getElementById('observaciones-count').textContent);
            const noConformes = parseInt(document.getElementById('no-conformes-count').textContent);
            
            let message = '';
            
            if (observaciones === 0 && noConformes === 0) {
                message = 'Complete el checklist para ver recomendaciones de asistencia.';
            } else if (noConformes > 0) {
                message = 'Se detectaron 铆tems no conformes que requieren atenci贸n prioritaria antes de considerar la compra.';
            } else if (observaciones > 3) {
                message = 'Se detectan m煤ltiples observaciones que pueden implicar gastos adicionales a considerar.';
            } else if (observaciones > 0) {
                message = 'Se detectaron observaciones que deben ser consideradas en la evaluaci贸n del veh铆culo.';
            }
            
            messageElement.textContent = message;
        }
        
        // Configurar eventos
        function setupEventListeners() {
            // Recomendaci贸n
            const recommendationOptions = document.querySelectorAll('.recommendation-option');
            recommendationOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remover selecci贸n anterior
                    recommendationOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Establecer nueva selecci贸n
                    this.classList.add('selected');
                    selectedRecommendation = this.dataset.value;
                    
                    // Actualizar vista previa
                    updatePreviewRecommendation();
                });
            });
            
            // Actualizar vista previa cuando cambian los datos
            const formInputs = ['vehiculo', 'dominio', 'kilometraje', 'fecha', 'fundamento', 'observacion-general'];
            formInputs.forEach(inputId => {
                document.getElementById(inputId).addEventListener('input', updatePreview);
            });
            
            // Bot贸n para actualizar vista previa
            document.getElementById('update-preview-btn').addEventListener('click', updatePreview);
            
            // Bot贸n para descargar PDF
            document.getElementById('download-pdf-btn').addEventListener('click', downloadPDF);
        }
        
        // Actualizar vista previa completa
        function updatePreview() {
            updatePreviewVehicleData();
            updatePreviewRecommendation();
            updatePreviewChecklist();
        }
        
        // Actualizar datos del veh铆culo en vista previa
        function updatePreviewVehicleData() {
            document.getElementById('preview-vehiculo').textContent = 
                document.getElementById('vehiculo').value || '[No especificado]';
            
            document.getElementById('preview-dominio').textContent = 
                document.getElementById('dominio').value || '[No especificado]';
            
            document.getElementById('preview-kilometraje').textContent = 
                document.getElementById('kilometraje').value || '[No especificado]';
            
            const fechaInput = document.getElementById('fecha').value;
            document.getElementById('preview-fecha').textContent = 
                fechaInput ? formatDate(fechaInput) : '[No especificada]';
            
            const observacion = document.getElementById('observacion-general').value;
            document.getElementById('preview-observacion-general').textContent = 
                observacion || '[Sin observaciones generales]';
        }
        
        // Actualizar recomendaci贸n en vista previa
        function updatePreviewRecommendation() {
            const fundamento = document.getElementById('fundamento').value;
            document.getElementById('preview-fundamento').textContent = 
                fundamento || '[No especificado]';
            
            const badgeElement = document.getElementById('preview-recomendacion-badge');
            
            if (selectedRecommendation === 'apto') {
                badgeElement.className = 'recommendation-badge badge-apto';
                badgeElement.textContent = 'Apto para compra';
            } else if (selectedRecommendation === 'observaciones') {
                badgeElement.className = 'recommendation-badge badge-observaciones';
                badgeElement.textContent = 'Apto con observaciones';
            } else if (selectedRecommendation === 'no-recomendado') {
                badgeElement.className = 'recommendation-badge badge-no-recomendado';
                badgeElement.textContent = 'No recomendado';
            } else {
                badgeElement.className = 'recommendation-badge';
                badgeElement.textContent = 'No seleccionada';
            }
        }
        
        // Actualizar checklist en vista previa
        function updatePreviewChecklist() {
            const summaryElement = document.getElementById('checklist-summary');
            summaryElement.innerHTML = '<h3 style="color: var(--primary-color); margin-bottom: 20px;">Resumen del checklist de inspecci贸n</h3>';
            
            // Agrupar por categor铆a
            Object.keys(categories).forEach(categoryKey => {
                const category = categories[categoryKey];
                const categoryItems = checklistItems.filter(item => item.category === categoryKey);
                
                if (categoryItems.length > 0) {
                    const categorySection = document.createElement('div');
                    categorySection.className = 'summary-category';
                    
                    const categoryTitle = document.createElement('h4');
                    categoryTitle.style.color = 'white';
                    categoryTitle.style.padding = '8px 15px';
                    categoryTitle.style.borderRadius = '4px';
                    categoryTitle.style.backgroundColor = getCategoryColor(categoryKey);
                    categoryTitle.textContent = category.name;
                    categorySection.appendChild(categoryTitle);
                    
                    categoryItems.forEach(item => {
                        const status = checklistStatus[item.id] || 'no-evaluado';
                        const statusText = getStatusText(status);
                        const statusClass = getStatusClass(status);
                        
                        const itemElement = document.createElement('div');
                        itemElement.className = 'summary-item';
                        
                        itemElement.innerHTML = `
                            <span>${item.text}</span>
                            <span class="summary-status ${statusClass}">${statusText}</span>
                        `;
                        
                        categorySection.appendChild(itemElement);
                    });
                    
                    summaryElement.appendChild(categorySection);
                }
            });
        }
        
        // Descargar PDF
        function downloadPDF() {
            // Verificar que se haya seleccionado una recomendaci贸n
            if (!selectedRecommendation) {
                alert('Por favor, seleccione una recomendaci贸n antes de generar el PDF.');
                return;
            }
            
            // Verificar que se haya ingresado el fundamento
            const fundamento = document.getElementById('fundamento').value.trim();
            if (!fundamento) {
                alert('Por favor, ingrese el fundamento de la recomendaci贸n antes de generar el PDF.');
                return;
            }
            
            // Crear un clon del reporte para el PDF
            const element = document.getElementById('report-preview');
            
            // Mostrar mensaje de generaci贸n
            const originalButtonText = document.getElementById('download-pdf-btn').innerHTML;
            document.getElementById('download-pdf-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generando PDF...';
            document.getElementById('download-pdf-btn').disabled = true;
            
            // Generar PDF
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new window.jspdf.jsPDF('p', 'mm', 'a4');
                const imgWidth = 190;
                const pageHeight = 280;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 10;
                
                pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Si el contenido es muy largo, agregar p谩ginas adicionales
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Agregar marca de agua discreta
                pdf.setFontSize(8);
                pdf.setTextColor(150, 150, 150);
                pdf.text('Desarrollado por AFM Solutions 路 afmsolutions.com.ar', 105, 285, { align: 'center' });
                
                // Descargar PDF
                const fecha = document.getElementById('fecha').value || new Date().toISOString().split('T')[0];
                const dominio = document.getElementById('dominio').value || 'informe';
                pdf.save(`Informe_AkinaCheck_${dominio}_${fecha}.pdf`);
                
                // Restaurar bot贸n
                document.getElementById('download-pdf-btn').innerHTML = originalButtonText;
                document.getElementById('download-pdf-btn').disabled = false;
            }).catch(error => {
                console.error('Error al generar PDF:', error);
                alert('Error al generar el PDF. Por favor, intente nuevamente.');
                
                // Restaurar bot贸n
                document.getElementById('download-pdf-btn').innerHTML = originalButtonText;
                document.getElementById('download-pdf-btn').disabled = false;
            });
        }
        
        // Funciones auxiliares
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-AR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
        
        function getCategoryColor(categoryKey) {
            switch(categoryKey) {
                case 'critical': return '#c0392b';
                case 'safety': return '#e67e22';
                case 'legal': return '#2980b9';
                case 'esthetic': return '#7f8c8d';
                default: return '#95a5a6';
            }
        }
        
        function getStatusText(status) {
            switch(status) {
                case 'conforme': return 'Conforme';
                case 'observacion': return 'Observaci贸n';
                case 'no-conforme': return 'No conforme';
                default: return 'No evaluado';
            }
        }
        
        function getStatusClass(status) {
            switch(status) {
                case 'conforme': return 'summary-status-conforme';
                case 'observacion': return 'summary-status-observacion';
                case 'no-conforme': return 'summary-status-no-conforme';
                default: return '';
            }
        }
    </script>
</body>
</html>
